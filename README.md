# PKU IAAA 自动登录插件

![演示截图](pic/screenshot.png)

## 简介
(IAAA)自动登录浏览器插件，支持自动填写用户名密码并处理多种认证方式，让你轻松访问需要IAAA认证的网站。

### 主要特性

- 🚀 **智能自动登录** - 自动检测认证方式并完成登录流程
- 🔐 **加密存储** - 使用 AES-GCM 256位加密存储密码，确保数据安全
- 📱 **多种认证支持** - 支持普通登录、短信验证、OTP认证
- 🎛️ **便捷控制** - 一键开启/关闭自动登录功能
- 🌐 **中文界面** - 完全中文化的用户界面
- 🔄 **无缝升级** - 自动将旧版本明文密码升级为加密存储

### 支持的认证方式

- **普通登录** - 仅用户名密码登录
- **短信验证** - 自动发送验证码并提示输入
- **OTP认证** - 支持手机App OTP验证
- **图形验证码** - 在需要时提示用户输入

## 安装与使用

### 安装方法

- 下载本项目到本地，并解压
- 打开Chrome/Edge浏览器，进入 `chrome://extensions/`
- 开启"开发者模式"
- 点击"加载已解压的扩展程序"，选择项目文件夹

### 使用指南

#### 初次配置
1. 点击浏览器工具栏中的北大Logo图标
2. 在弹出窗口中输入你的北大账号用户名和密码
3. 点击"保存"按钮
4. 确保"自动登录"开关为开启状态

#### 功能说明
- **保存** - 保存用户凭据并启用自动登录
- **更新** - 更新已保存的用户凭据（首次保存后显示）
- **清除** - 清除所有保存的登录信息并关闭自动登录
- **自动登录开关** - 在不删除凭据的情况下启用/禁用自动登录

#### 使用流程
1. 配置完成后，访问任何需要IAAA认证的网站
2. 插件会自动填写用户名和密码
3. 根据网站要求的认证方式自动处理：
   - 普通登录：直接完成登录
   - 短信验证：自动发送验证码，等待用户输入
   - OTP认证：显示OTP输入框，等待用户输入
4. 按提示完成剩余步骤即可成功登录

## 技术信息

### 项目结构
```
PKU-IAAA-AUTO-LOGIN/
├── manifest.json          # 扩展清单文件
├── popup.html             # 弹窗界面
├── popup.js               # 弹窗逻辑
├── iaaa.js                # 核心自动登录脚本
├── crypto-utils.js        # 密码加密工具
├── jquery-3.7.1.min.js    # jQuery库
├── bootstrap.min.css      # Bootstrap样式（压缩版）
├── Toggle-Switch.css      # 开关组件样式
├── icon*.png              # 扩展图标
└── pic/                   # 文档图片
    └── screenshot.png
```

### 支持的网站
- 北京大学统一身份认证 (iaaa.pku.edu.cn)
- 包括门户、教学网、选课网等

### 浏览器兼容性
- **Chrome 88+** (支持 Manifest V3)
- **Microsoft Edge 88+** (支持 Manifest V3)
- **其他基于 Chromium 的现代浏览器**

**重要提示**: 
- 本插件已全面升级到 Manifest V3，确保长期兼容性
- 推荐使用最新版本的 Chrome 浏览器以获得最佳体验
- 旧版本浏览器可能不支持某些新特性

### 隐私与加密说明

- 插件使用 AES-GCM(256位) 加密存储密码，密钥保存在浏览器的本地存储中（chrome.storage.local），不会随账号同步到其它设备。
- 为了安全性考虑，加密后的密码存放在 chrome.storage.sync 中，便于配置跨设备同步，但由于密钥不随之同步，换到新设备后将无法解密，需要在该设备上重新保存一次密码。
- 如需彻底移除本地敏感信息，请在弹窗中点击“清除”，并考虑通过浏览器设置清理“站点数据/扩展数据”。

## 更新日志

### v2.0 (2025年10月)
- 🚀 **重大升级**: 迁移到 Manifest V3，确保与未来浏览器版本兼容
- 🔒 **安全升级**: 实现 AES-GCM 密码加密存储，彻底解决明文密码安全隐患
- 🛡️ **依赖升级**: jQuery 升级到 3.7.1，Bootstrap 升级到 v5.3.8
- 🎨 **UI现代化**: 修复 Bootstrap 5 兼容性问题，提供更现代的界面
- 🔧 优化权限配置，增加 host_permissions 支持
- 📱 改进扩展动作(action)配置，提供更好的用户体验
- ✨ 全面重构代码，提升稳定性和可读性
- 🐛 修复自动登录功能在新版本Chrome中的兼容性问题
- 💄 优化用户界面，增强用户体验
- 📝 完善中文文档和注释
- 🔒 增强错误处理和安全检查机制
- 🔄 自动升级机制：无缝将旧密码升级为加密存储
- 🗑️ 移除不再使用的course和mail功能，专注核心功能


## 参考

本项目基于 "Cyberoam Auto Login" 开发
